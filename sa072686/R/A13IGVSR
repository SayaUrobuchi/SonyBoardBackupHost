§@ªÌ: newmoon (¶¯¤¤ªº­Ë·°°­) ¯¸¤º: sa072686
¼ÐÃD: [ACM] 10625(À°¦£°£¿ù)
®É¶¡: 2007/10/31 Wed 20:53:39

§Ú¬Ý¤F¦n¤[§ä¤£¨ì¿ù¦b­þ
¥i¥HÀ°¦£§ä¤@¤U¶Ü¡H
#include<stdio.h>
long long a[127][127],b[127][10001];
int t,r,d,i,j,k,q;
long long an;
char c,s[110],tr[127];
main(){
    scanf("%d",&t);
    while(t--){
        for(i=33;i<127;i++){
            tr[i]=0;
            for(j=33;j<127;j++)a[i][j]=0;
        }
        scanf("%d",&r);
        while(r--){
            scanf("%c",&c);
            scanf("%c->%s",&c,s);
            for(i=0;s[i]!=0;i++){
                a[c][s[i]]++;
                tr[c]=1;
            }
        }
        scanf("%d",&q);
        while(q--){
            scanf("%s %c %d",s,&c,&d);
            for(i=0;s[i]!=0;i++)
                b[s[i]][0]++;
            for(i=1;i<=d;i++)
                for(j=33;j<=126;j++){
                    if(tr[j]!=0){
                        for(k=33;k<=126;k++)
                            b[k][i]+=b[j][i-1]*a[j][k];

                    }
                    else b[j][i]+=b[j][i-1];
                    b[j][i-1]=0;
                }
            an=b[c][d];
            printf("%I64d\n",an);
            for(i=33;i<=126;i++)b[i][d]=0;
        }
    }
}

--
[1m               [42m¢q[40m¢w¢¡                  ¢~¢w¢w¢w¢w¢w¢w¢w¢¡[m
[1m               ¢x  ¢x[1m¥[mx«[1mn¤@¤[m¤¡D¯[1mÁ¥§¤[mp¯[1m¸[m¡ý[1msony.TFcis.org¢x  ¢x[m
[1m                   ¢¢¢w¢w¢w¢w¢w¢w¢w¢w¢w¢£              ¢¢¢w[42m¢q[m
[1m               by newmoon from [m [1m124.8.174.200 (ºÖº¸¼¯¨F©Tºô)[m

¡÷ [36msa072686 [31m±À[m:¶ÇACM ¤£¯à¥Î %I64d ­n¥Î %lld ­ò                      1031 21:01
¡÷ [36msa072686 [31m±À[m:³á§Ú¿ù¤F¡AAC±¼¤F¡Aºâªk¨S¿ù¡A¥i¬O¥¦»¡¬OµL¸¹ 64 bit    1031 21:14
¡÷ [36msa072686 [31m±À[m:½Ð¥Î unsigned long long °t %llu §Y¥i AC              1031 21:14
¡÷ [36mnewmoon [33m»¡[m:´ú¸Õ                                                  1031 21:27
¡÷ [36mnewmoon [33m»¡[m:´ú¸Õ                                                  1031 21:27
