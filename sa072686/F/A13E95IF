§@ªÌ: sa072686 (ÁÙ¤Ó®z¡K½m§a¡C) ¯¸¤º: sa072686
¼ÐÃD: [ACM] 10860
®É¶¡: 2007/09/10 Mon 08:56:47

¥X¥G·N®Æ¦a¦n¸Ñ¡C¶â¡K

¨S·Q¨ì¨S¤Ó¦Ò¼{®Ä²v°ÝÃD¡A¥Î¤£«ç»ò¦³®Ä²vªº¤èªkÁÙ¬O¹L¤F

¥u¬O¸£´Ý§Ñ¤F reverse µ²ªG wa ±¼¤@¦¸¡K

Â½Ä¶¤@¤U


    ¦pªG±N¤@¦ê«Üªøªº¦r¦ê¤À¸Ñ¦¨¤@¨Ç¤p¦r¦êªº¸Ü¡A¨º»ò¬Ý°_¨Ó±N¤£·|¨º»ò¦aªø

§A¥²¶·§ä¥X¤@­Óªø¦r¦ê¬O§_¥i©î¦¨¥Ñ«ü©wªºµu¦r¦ê²Õ¦X¦Ó¦¨ªº§Î¦¡¡C


    §A¥²¶·ª`·N¥H¤U´XÂI¡G

        ¤@¡B©Ò¦³ªº¦r¦ê¥H ASCII 33 ¨ì 127 ©Ò²Õ¦¨¡C

        ¤G¡B©Ò¦³µu¦r¦ê¥H¤Î¥¦­Ì¸g¤ÏÂà©Òºc¦¨ªºµu¦r¦ê¥i¨Ï¥ÎµL­­¦¸¡C

        ¤T¡B¤@­Óµu¦r¦ê©Î¨ä¤ÏÂà¦¨ªºµu¦r¦ê¡A¨C¨Ï¥Î¤@¦¸³£ºâ¬O¥X²{¤@¦¸¡C


    ·í§A¨Ï¥Îµu¦r¦ê²Õ¦¨ªø¦r¦ê®É¡A§A§Æ±æµu¦r¦êªº¥X²{¦¸¼Æ·U¤p·U¦n¡C


    ¨Ò¦p·í§Ú­Ì·Q¨Ï¥Î "a"¡B"abb"¡B"bb" ¨Óºc¦¨ "aabbabbabbbb" ®É¦³¦n´XºØ¤èªk¡C

"a-abb-abb-abb-bb" »P "a-abb-a-bba-bb-bb" ¬O¨ä¤¤¥i¦æªº¨âºØ¡C

¦ý§Ú­Ì§Æ±æ¨Ï¥Î«eªÌ¡A¦]¬°¥¦¥u»Ý­n 5 ­Óµu¦r¦ê¡A«áªÌ­n¥Î 6 ­Ó¡C

¤£¹L¡A§Ú­Ì¥u¹ï³Ì¤Ö»Ý­n´X­Óµu¦r¦ê¦³¿³½ì¡A¦]¦¹§A¥u­n§ä¥X³Ì¤Ö»Ý­n´X­Ó´N¥i¥H¤F¡C


Input

    ¿é¤Jªº²Ä¤@¦æ¦³¤@¼Æ¦r s¡]s<51¡^¥Nªí¦³´X²Õ´ú¸Õ¸ê®Æ¡C¨C²Õªº²Ä¤@¦æ¬Oªø¦r¦ê p

¡]0 < length(p) < 10001¡^¡C¤U¤@¦æ¦³¤@¼Æ¦r n¡]0 < n < 51¡^¥Nªí¦³´X­Óµu¦r¦ê

±µ¤U¨Óªº n ¦æ¦³¤@µu¦r¦ê pi¡]0 < length(pi) < 101¡Ai = 1¡A2¡A3¡A...¡An¡^

§A¥i¥H©ñ¤ß¦a°²³]¿é¤J¤¤¤£·|¦³ªÅ¦r¦ê©ÎªÅ¥Õ²Å¸¹¡C


Output

    ¹ï¨C¤@²Õ´ú¸Õ¸ê®Æ¿é¥X¤@¦æ¡G

        Set S: C.
        Set S: Not possible.

    ­Yªø¦r¦ê¥i¥Ñµu¦r¦ê²Õ¦¨¡A«h¿é¥X«eªÌ¡F§_«h¿é¥X«áªÌ¡C

    S ¥Nªí³o¬O²Ä´X²Õ´ú¸Õ¸ê®Æ¡CC ¥Nªí²Õ¦¨ªø¦r¦ê»Ý­n¨Ï¥Îªº³Ì¤Ö¦¸¼Æ¡C

§ó¸Ô²Óªº®æ¦¡½Ð¨£©³¤Uªº Sample Output

// Ä¶µù¡G©³¤U¬O solution ¤F¡A Sample IO ½Ð¨£­ì¥»ªºÃD¥Ø
// ¤Ï¥¿¤£ÂI¶i¥h¨ºÃDªºÃD¥Ø¤]¤£¯à¤W¶Ç¡A¬ì¬ì










---- ¤À¹j½u ----











¨ä¹ê¤£·|¤ÓÃø¡A®É¶¡¦ü¥G¤£ºò¡C¶â¡A­º¥ý·|·Q»¡¹ï©ó¨C­Óªø«×¦Ó¨¥

§Ú­Ì¥u»Ý­n³Ì¨Îªº¡C¤]´N¬O»¡¡A«Ü®e©ö·Q¨ì±qªø«× i ¨Ï¥Î¤@­Óµu¦r¦ê²Õ¨ìªø«× j

¨º»ò§Ú­Ì»Ý­nª¾¹Dªº¬Oªø«× i ªº³Ì¨Î¸Ñ¡A¦]¬°¦P¼Ë¨Ï¥Î¤@­Óµu¦r¦êªº¸Ü

¨Ï¥Î³Ì¨Îªº¤è¦¡²Õ¦¨ªø«× i ¦A¥[¤W¤@­Óµu¦r¦ê·|¤ñ¸û¦n

¦]¦¹¡A§Ú­Ì«O¯d¦r¦ê¤¤¨C­Óªø«× i ªº³Ì¨Î¸Ñ¡A¦A¬Ý¬Ý¯à°t¤W­þ­Óµu¦r¦ê

¦A©µ¦ù¥X¥h¡A³o¼Ë¤l¡A¦]¦¹¨Ï¥Î DP[i] ¥Nªí¨ìªø¦r¦êªø«× i ®É³Ì¤Öµu¦r¦ê¼Æ

¨º»òªTÁ|©Ò¦³¦bªø«× i ®É­è¦n¥i¥H¨Ï¥Îªºµu¦r¦ê s

«h DP[i+len(s)] ¥i¥Ñ DP[i] + 1 ¦Ó¨Ó¡A¥u­nÀË¬d¥¦¬O¤£¬O¤ñ¸û¦nªº¸Ñ§Y¥i

³o¼Ë³]ªø¦r¦êªø«× n¡A¹ï©ó¨C­Óªø«× i ªTÁ| m ­Óµu¦r¦ê¤Î¥¦­Ìªº¤ÏÂà

³]µu¦r¦êªø«×³Ìªø l «h³Ì®t±¡§Î¬O O(n * m * l)¡A³Ì®t¬O 10000 * 50 * 100

¤£¹L®Ä²v¤´¥i¥H±µ¨ü¡C¨Ã¥B¡A¤£¥H DP[i] ¥hÀË¬d©Ò¦³ DP[i-len(s)] ªº¸Ü

¨º»ò¥Ñ©ó DP[i] ¥i¯à¬Oµ}²¨ªº¡A´N¥i¥H´î¤Ö¤£¤Öªº®É¶¡

--

¥x«n¤@¤¤¸ê°TªÀ¤E¤C¯Å§C½Õ®`²Ûªº¤p±Ð¾Ç~*

ACM±b¸¹¡G11557


--
[1m               [42m¢q[40m¢w¢¡                  ¢~¢w¢w¢w¢w¢w¢w¢w¢¡[m
[1m               ¢x  ¢x[1m¥[mx«[1mn¤@¤[m¤¡D¯[1mÁ¥§¤[mp¯[1m¸[m¡ý[1msony.TFcis.org¢x  ¢x[m
[1m                   ¢¢¢w¢w¢w¢w¢w¢w¢w¢w¢w¢£              ¢¢¢w[42m¢q[m
[1m               by sa072686 from [m [1m192.168.4.15 (¥x¯T¤@¤¤®áÆF¾j)[m

