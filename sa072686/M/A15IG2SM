§@ªÌ: sa072686 (AC Island ¶}µo¤¤)
¼ÐÃD: [Âà¿ý] [¾Ç³N] ACM 11698 Accepted
®É¶¡: 2009/12/16 Wed 06:20:06

¡° ¥»¤åÂà¿ý¦Û [sa072686] «H½c

§@ªÌ: sa072686.bbs@ptt2.cc
¼ÐÃD: [¾Ç³N] ACM 11698 Accepted
®É¶¡: 2009/12/16 Wed 06:19:35

§@ªÌ: sa072686 (sa) ¬ÝªO: sa072686
¼ÐÃD: [¾Ç³N] ACM 11698 Accepted
®É¶¡: Wed Dec 16 06:14:28 2009

¤@¶}©lÁÙ¥H¬°¦Û¤v°h¤Æ¤F¡A¾Ç©f¥á¤F­Ó³sµ²»¡³oÃDAC²v«Ü°ª¦ý¦o¬Ý¤£À´ÃD·N

ªá¤F¤@­Ó¤p®É¤W¤U¬ÝÀ´«áÄ±±o«ÜÃø·Q¡A«ç»ò·|¬O°ªAC²vªº¸£´ÝOrz

µ²ªGÂI¦^¦Cªí¤@¬Ý¡A¡K¡A°ªAC²v¦ý¬O¥u¦³2X­Ó¤HAC°Ú°Ú°Ú°Ú°Ú°Ú

·Q¤F¤@¨â­Ó¤U¤È«á·Q¥X¨Ó¤F¡A¹ê§@¤]³B²z¤F¤@­Ó±ß¤W¡K·Qªk¤@Âà¦AÂà Orz

Â²Ä¶¤@¤U¡K

¹ï©ó¤@­Ó 1~n ªº¥ô·N±Æ¦C¡A©w¸q¨ä order ¬° k ®É¥Nªí k ¬O³Ì¤pªº¥¿¾ã¼Æ¡A

¨Ï±o±q 1~n ¤§¶¡¥ô¤@¼Æ¦r¶}©l¡A§¡º¡¨¬±N¨ä¥N´« k ¦¸¡A¨C¦¸¥N´«®É§â¥Ø«e¼Æ¦r x

´«¦¨¨ä¦b¦¹±Æ¦C¤¤ªº¦ì¸m¡A«ê·|´«¦^­ì¥ý°_©lªº¼Æ¦r

¨Ò 2 3 1 ¹ï¼Æ¦r 1 ·|¥N´«¦¨¨ä¦ì¸m 3¡A¦A¥N´«¦¨ 3 ªº¦ì¸m 2¡A¦A¥N´«¦¨ 2 ªº¦ì¸m 1

¦@¥N´« 3 ¦¸¦^¨ì­ì¥»¼Æ¦r¡A¹ï©ó¼Æ¦r 2 ¹Lµ{¬° 2->1->3->2¡A¼Æ¦r 3 ¬° 3->2->1->3

¦¹§Ç¦C¤§ order ¬° 3¡A²{¦bµ¹§A n, m ¸Õ¨D 1~n ªº©Ò¦³±Æ¦C¤§¤¤¡A

order «ê¬° m ªÌ¦³¦h¤Ö­Ó¡An <= 100, m <= 2147483647, µª®× mod 2147483647.



¨¾¹p






















­º¥ý¤£Ãø·Q¨ì¡A¥i¥H±N³oÃDÂà´«¤@¤U¡A§â¤@­Ó§Ç¦C©î¦¨¼Æ­Ó¿W¥ßªº¶°¦X

³o¨Ç¶°¦X¤¤¥ô¤@¼Æ¦r¶}©l¡A§¡·|Â¶¹L©Ò¦³¼Æ¦r«ê¤@¦¸«á¡A¦^¨ì¦Û¨­

¦]¬°¤@­Ó¼Æ¥u·|«ü¦V¤@­Ó¦ì¸m¡A¤@­Ó¦ì¸m¤]¥u³Q¤@­Ó¼Æ«ü¦V

¥i¥ÎÃþ¦ü¤×©Ô¸ôªº¤è¦¡ÃÒ©ú¤§¡C¦Ó¶°¦Xªº¤¸¯À­Ó¼Æ¥NªíÂ¶¦^¦Û¤v©Ò»Ýªº¥N´«¦¸¼Æ¡A

¦]¦¹ªø«× i ªº¶°¦X¦b i ªº­¿¼Æ¦¸¥N´«®É¡A¨C­Ó¤¸¯À³£¥i¥H³Q´«¦^¦Û¨­¡C

©ó¬OÃD¥Ø©Ò¨DÅÜ¦¨¡G±N 1~n ©î¦¨³\¦h¿W¥ßªº¶°¦X¡A¨Ï¶°¦X¤j¤pªº³Ì¤p¤½­¿¼Æ«ê¬° m

Âà¤Æ¨ì³o¦a¨B®É¡A¥Ñ©ó²o§è¨ì³Ì¤p¤½­¿¼Æ¡A´N«ÜÃø¥Î¼Æ¾Ç¨D¸Ñ¤F

¦ý¬O­nºâ­Ó¼Æ¡A¥»¨­¤S¦³±Æ¦C²Õ¦Xªº¨ý¹D¡A©ó¬O¥i¥H¹Á¸Õ¥Î DP ¸Ñ¸Ñ¬Ý

¥i¬O³ÌÃø´x´¤ªº³¡¥÷¡A¤]´N¬O³Ì¤p¤½­¿¼Æ¡A¶Õ¥²­n·í¦¨ª¬ºA¤§¤@

m ªº½d³ò¬O < 2147483647 ¤Ó¤j¤F¡A°}¦C¦s¤£¤U¡A¤]¤@©w·|¶]¤ÓºC

©Ò©¯§Ú­Ì¥i¥HÃÒ©ú¹ï©ó¤@­Ó¼Æ¦r k, ­Y k ¤£¬° m ªº¦]¼Æ¡A

«h¤£¦s¦b¥ô¤@¾ã¼Æ p ¨Ï±o lcm(p, k) = m. ÃÒ©ú¦p¤U¡G

³] lcm(p, k) = m ¥B m%k != 0¡A¤wª¾ lcm(p, k) ¬° p*k/gcd(p, k),

¦Ó gcd(p, k) ¥²¾ã°£ p »P k, ¬G lcm(p, k) ¥i¼g§@ k*(p/gcd(p, k))

p/gcd(p, k) ¥²¾ã°£¡A¬G¬°¥¿¾ã¼Æ¡A©Ò¥H m ¬° k ªº­¿¼Æ¡A¦ý k ¤£¬O m ªº¦]¼Æ¡A¥Ù¬Þ

¦Ó m ªº¦]¼Æ­Ó¼Æ¦b 2000 ­Ó¥H¤º (¤£¹L¦³¥i¯à¶W¹L 1000 ­Ó)

§Ú­Ì¥uÃö¤ß³Ì¤p¤½­¿¼Æ¬° m ªº­¿¼Æªºª¬ºA¡A©Ò¥H±Nª¬ºAÀ£¦¨ m ªº²Ä k ¤j¦]¼Æ

³o¼ËªÅ¶¡©M®É¶¡´N³£¤£­P©ó¤Ó¸Ø±i¡C

ª¬ºAªº³¡¥÷¡A§Ú­ÌÃö¤ß³Ì¤p¤½­¿¼Æ¡A©Ò¥Hª¬ºA¤@©w¦³¥¦

§Ú­Ì¤]Ãö¤ßÁÙ¦³¦h¤Ö¤¸¯À©|¥¼³Q¹º¤À¨ì¶°¦X¤¤¡A©Ò¥H¤]¤@©w­n¦³

³oÃþÃD¥Ø§Ú­Ì³q±`Ãö¤ß­«ÂÐ­pºâªº°ÝÃD¡A¤]Ãö¤ß·|¤£·|¿òº|¸Ñªº°ÝÃD

¨C¦¸§Ú­Ì¦Ò¼{¦b¬Y¤@ª¬ºA¤¤¡A¥[¤J¤@­Ó·sªº¶°¦X

°²³]§Ú­Ì²{¦b¦³­Ó 1~n ¨Ì§Ç±Æ¦nªº§Ç¦C

²{¦b±q¤¤¬D¥X q ­Ó¼Æ§@¬°¤@­Ó·s¶°¦X¡AµM«á§Ú­Ì±N³o·s¶°¦X¥´¶Ã¦Ü»Ý­n q ¦¸¥N´«

¤~´«±o¦^¨Ó­ì¥»ªº¼Æ¦r¡C³oÁ`¦@¦³ (q-1)! ºØ¤è¦¡¡A±À¾É¦p¤U¡G

±q¥ô·N¼Æ¦r r ¶}©l¡A¥Ñ©ó¥¦¤£¯à¦b¦Û¤v­ì¥»ªº¦ì¸m¤W¡A§_«h¤£¯à¹F¨ì q ¦¸¥N´«

¯à q ¦¸¥N´«ªº±ø¥ó¬O¯à°÷¤@°éÂ¶§¹©Ò¦³¤¸¯À¡A©Ò¥H¥¦¤£¯àÂ¶¦^¦Û¤v

¥ô¿ï¤@­Ó«D­ì¥»¦ì¸m¦@¦³ q-1 ºØ¿ï¾Ü¡A³o®É¥Øªº¦aªº¼Æ´N³Q»°¤F¥X¨Ó

¥¦¤£¯à¿ï¾Ü¤@¶}©l¨º¼Æªº¦ì¸m¡A¤]¤£¯à¿ï¾Ü­ì¥ýªº¦ì¸m¡A³o³£·|¾É­PÂ¶¤£¤F¤@°é

¬G¥¦¥u³Ñ q-2 ºØ¿ï¾Ü¡A¨Ì¦¹Ãþ±À¡Aª½¨ì³Ì«á¤@­Ó¼Æ¥u³Ñ¤@ºØ¿ï¾Ü¡A´N¬O¨ì¤@¶}©l¨º¼Æ

ªº¦ì¸m¤W¡A¬GÁ`¦@¦³ (q-1) * (q-2) * .. * 1 ºØ¡A¤]´N¬O (q-1)! ºØ¿ï¾Ü

¦b¤w³Q¹º¤À¦Ü³Ñ¤U p ­Ó¤¸¯Àªºª¬ºA¤¤¡AÁöµM³o¨Ç±¡§Î¬O¬Û²§ªº

³Ñ¤U p ­Ó¤¸¯Àªº¯S©Ê¤]¬O¦@¦Pªº¡C¤§«á¤´µM¬OÄ~Äò¥[¤J·s¶°¦X¡B¹º¤À³Ñ¤Uªº¤¸¯À¡C

ÁöµM¹ï©ó³Ñ¤Uªº p ­Ó¤¸¯À¬Ý¦ü¥i¥HÀH·N¥h³B²z¡B¹º¤À¡A¤]¤£¥Î©È­«ÂÐ

¦ý¦pªGª¼¥Ø¦a¹º¤À¡AÁÙ¬O·|­«ÂÐ¡C¦]¬°³o¨Ç±¡§Îªº®t²§¨Ã¤£¨¬¥HÅý

±µ¤U¨Óªº p ­Ó¤¸¯ÀµL½×«ç»ò¹º¤À¡A³£¤£­P©ó¥X²{¬Û¦Pªº±¡§Î¡C

Á|­Ó¨Ò¡A­Y·s¶°¦X¤j¤p¬° q «h§Ú­Ì¦³ c(p, q) ºØ¤è¦¡¥i¥H¨M©w·sªº¶°¦X¡A¥i¬O©O

¥ý¨ú q=2 ¦A¨ú q=3 µ¥¦P©ó¥ý¨ú q=3 ¦A q=2

¥ý¨ú 2 ¨ú¨ì #2##2¡A¥ý¨ú 3 ¥i¯à¨ú 3#33# ¨º»ò³o¨âªÌ´N·|­«ÂÐ¤F¡C

¬°¤FÁ×§K³oºØ±¡§Î¡A¦³¥H¤U¨âºØ«ä¸ô

²Ä¤@ºØ«ä¸ô¬O¡A·Q¿ìªkÅý¨C¦¸¨ú¶°¦X®É¡A¶¶§Ç¥ý«á¤£³y¦¨­«ÂÐªºµ²ªG

¨C¦¸ª¼¨úªº¸Ü¥i¯à¥ý¨ú©M«á¨úªºµ²ªG¥X²{­«Å|¡A¤ñ¦p»¡ 5 ­Ó¤À¦¨ 3 ©M 2 ®É

§Ú¥ý¨ú 3 ªº±¡§Î·|¨ú¨ì #33#3¡A¥ý¨ú 2 ªº±¡§Î·|¨ú¨ì 2##2#

³o®É¥ý¨ú 3 ©M¥ý¨ú 2 ·|¨ú¨ì¬Û¦Pµ²ªG¾É­P­«ÂÐ¡A¬°¤FÁ×§K³oºØ±¡§Î

§Ú­Ì¥i¥H³W©w¨C¦¸¨úªº®É­Ô¤@©w­n¨ú¨«¥i¨ú¤¸¯À¤¤ªº²Ä¤@­Ó

³o¼Ë¥ý¨ú 3 ªº¸Ü¡A²Ä¤@­Ó¤@©w³Q 3 ¨ú¨«¡F¥ý¨ú 2 ®É²Ä¤@­Ó¤@©w¬O³Q 2 ¨ú¨«

©Ò¥H²Ä¤@­Ó¤@©w¤£¦P¡A­«ÂÐ´N¤£·|µo¥Í¡C³o¨Ï±o§Ú­Ì³Ñ¤U c(p-1, q-1) ºØ¿ï¾Ü¡C

¦ý¦b¨CºØª¬ºA¤¤¡A²Å¦X¸Óª¬ºAªº¨C­Ó±¡§Î³£¤w³Q½T«O«áÄòªº¤¸¯ÀµL½×¦p¦ó¹º¤À

³£¤@©w¤£·|¥X²{¬Û¦Pªº±¡§Î¡C©ó¬OªTÁ|©Ò¦³ª¬ºA dp[i][j]

¤]´N¬O¤w¹º¤À i ³Ì¤p¤½­¿¼Æ¬° m ªº²Ä j ¤j¦]¼Æ®Éªº±¡§Î¼Æ

ªTÁ|©Ò¦³¥i¹º¤À¶°¦X¤j¤p q¡A«Kª¾©Ò¦³ª¬ºA dp[i+q][hash[lcm(j, q)]]

§¡¥i¥Ñ dp[i][j] ¹º¤À¶°¦X q ¨Ó¹F¦¨¡A¥B¤èªk¼Æ¬O dp[i][j]*c(n-i-1, q-1)*(q-1)!

¨ä¤¤ c ©M¶¥­¼§¡¥i¹w³B²z¡A¬G¬° O(1), ª¬ºA¼Æ n*m ¥BÂà²¾¬° n

³Ì®t±¡§Î 100*100*2000 ºâ¬O¦X²zªº½ÆÂø«×¡A¹ê»Ú¹B¦æ®É¶¡¬° 0.848 ±Æ¦W 17

²Ä¤GºØ«ä¸ô¬O¦b¹º¤À¶°¦Xªº¹Lµ{¤¤¡A³W©w¤@­Ó¶¶§Ç¡A¨Ï±o¹º¤À¤£·|­«ÂÐ¡C

¨Ò¦p¤W­zªº¥ý¹º¤À q=2 ¦A q=3 µ¥¦P©ó¥ý q=3 ¦A q=2¡A¨º»ò§Ú­Ì³W©w¡G

¹º¤À¹Lµ{¤¤ q ¥²¶·ÄY®æ»¼¼W¡A«K¦¨¥\¦a¸Ñ¨M¤F³o­Ó°ÝÃD

¦ý¦P®É¥¦¤]±a¨Ó¤F¨â­Ó°ÝÃD¡A²Ä¤@­Ó°ÝÃD¬Oª¬ºA¥i¯à»Ý­n¼Wºû¨Ó°O¿ý³Ì¤j¶°¦X¤j¤p

²Ä¤G­Ó°ÝÃD¬O¦p¦ó³B²z¬Û¦P¤j¤pªº¶°¦X¡A§Ú­Ì¥ý¨Ó±´°Q²Ä¤@­Ó°ÝÃD

¦pªG¼Wºûªº¸Ü¡Aª¬ºA±N¦³ n*n*m ­Ó¡A¨C­Ó­nªTÁ| n ºØ¶°¦X¤j¤p¡A²z½×¤W¤ÓºC

¦]¦¹§Ú­Ì·Q¿ìªk­°ºû¡A§ï¥HªTÁ|¹º¤À¶°¦X¤j¤p q ¬°¥D¡A¦AªTÁ|¨C­Óª¬ºA

¤£Ãøµo²{¨C¦¸¹º¤À¡A¹ï©óª¬ºA dp[i][j] ¤w¹º¤À¤¸¯À¼Æ¶q i ¥u¼W¤£´î¡A

¹ï©ó³Ì¤p¤½­¿¼Æ j «hºû«ù¤£»¼´îª¬ºA¡A¬G¹ï©ó i ©M j §¡±q¤jªTÁ|¨ì¤pªº¸Ü

¨º»ò¦bªTÁ|¨ì®É¡A«OÃÒ¤´¥¼¹º¤À¹L¥Ø«eªTÁ|¨ìªº¶°¦X¤j¤p q

³o®É¥i¥H©ñ¤ß§â q ¹º¤À¤U¥h¡A´N¯à«OÃÒ¹º¤À¹Lµ{¤¤¶°¦X¤j¤p§eÄY®æ»¼¼W¤F

ª¬ºA¤@¼Ë¥u¦³ n*m ­Ó¡AªTÁ| n ºØ¶°¦X¤j¤p¡A½ÆÂø«×©|¦b¦X²z½d³ò¤º

±µ¤U¨Ó°Q½×²Ä¤G­Ó°ÝÃD¡A¦³­Ó³Ì±`¨£ªº¸Ñ¨M¤è¦¡¡A´N¬O¤@¦¸©ñ¨¬

³oÃþ°ÝÃD¥D­n°_¦]©ó·í¤w¹º¤À¶°¦X¤¤¤]¦³¤j¤p q ªº¶°¦X®É·|¾É­P­«ÂÐ­pºâ

¦ý«o¤S²VÂø¦b¤@°_¡AµLªk©Î¤£·Q¼Wºû¨Ó¤ÀÂ÷¥¦­Ì

³o®É¤£¦p±N³o¨Ç©ñ¦b¤@°_¦Ò¼{¡AªTÁ|¤j¤p q ªº¶°¦XÂ\©ñ­Ó¼Æ p

µM«á±N³o p ­Ó¶°¦X¤@¦¸©ñ¶i¥h¡A¤j³¡¥÷±¡§Î§¡¥i¥H¦¹¸Ñ¨M

¦ý³o p ­Ó¶°¦X¥i¥ô·N¤¬½Õ¶¶§Ç¡A­n°£­Ó p!¡A¥i¬O¦b¨ú¾l¤¤¤£¯à¨Ï¥Î°£ªk

¤]µLªk°µ¦]¦¡¤À¸Ñ¤§Ãþªº¨Æ¡A¦]¦¹¤´­n­É§U²Ä¤@ºØ«ä¸ô¡A

¨C©ñ¤@­Ó¶°¦X´N¤@©w§â¥i¨úªº²Ä¤@­Ó¤¸¯À¨ú¨«¡A«á©ñªº¶°¦X©M¥ý©ñªº¶°¦X

´N¤£¥i¯à¥X²{¦ì¸m¹ï½Õªº±¡§Î¡A«K¨S¦³­«ÂÐªº°ÝÃD

¦]¦¹©ñ¸m³o p ­Ó¶°¦Xªº¤èªk¼Æ¬° c(pq-1, q-1)*c((p-1)q-1, q-1)*...*c(q-1, q-1)*

(f(q-1)^p)*dp[i][j]*c(n-i, pq)¡AÂà²¾¥Øªº¦a¤@¼Ë¬O dp[i+q][hash[lcm(j, q)]]

«e­±ªº³s­¼¬O°w¹ï³o pq ­Ó¤¸¯À¡A¤À°tµ¹³o p ­Ó¤j¤p q ªº¶°¦X

¤§«á¨C­Ó¶°¦X­n¥´´²¥i¥H¦³ f(q-1) ºØ¤è¦¡¡Ap ­Ó¶°¦X´N¦³ f(q-1)^p ºØ

±µ¤U¨Ó¬O¹ï©ó©Ò¦³³o¼Ëªºª¬ºA¡A¤Á¥X¤@¶ô¤j¤p pq ¥h¹º¤Àµ¹³o p ­Ó¶°¦Xªº¤èªk¼Æ

³o¼Ëªº¤èªk¥Ñ©óÁÙ­nªTÁ| p ¦]¦¹¤ñ¸ûºC

¦ý¥Ñ©óªTÁ|¶°¦X¤j¤p q ¦b³Ì¥~ÀY¡A¦]¦¹¥i¥H¦Ò¼{¥ýªTÁ|³Ì¤p¤½­¿¼Æ j

¤@¥¹ lcm(j, q) ¤£¬O m ªº¦]¼Æ§Y±Ë¥h¡A¥i¥H¥[§Ö¤£¤Ö

¨ì³o¸Ì¹ê»Ú¯Ó®É 1.152 ±Æ¦W 21 ¦ô­p¤£¥[³o¤@ÂI¥i¯à·|¾É­P TLE

¤§«áªTÁ|¤w¹º¤Àªø«× i ®É­Y¬O dp[i][j] ¬° 0 «h¤£¦Ò¼{ªTÁ|¶°¦X q ªº­Ó¼Æ p

¥i¥H§Ö­Ó¤Q­¿¥ª¥k¡A¯Ó®É 0.124 ±Æ¦W 7¡A§â¬d¸ß¬Y¼Æ¬° m ²Ä´X¤j¦]¼Æªº³¡¥÷

§ï¥Î¤G¤À·j´Mªk¡A«h¯Ó®É³Ñ¤U 0.84 ±Æ¦W 5¡A­Y¥Î hash table µ¥¸êµ²¤]³\¥i¥H§ó§Ö

ºâ¬O«ÜÃø·Q¡A»Ý­n¤@¨Ç¸gÅçÂà¤ÆÃD¥Ø¡B¹B¥Î DP¡A¨Ã¥B»Ý­n§Þ¥©À£ª¬ºA¡B

³B²z­«ÂÐ»P­pºâ­Ó¼Æµ¥µ¥¡A¬O²V¦X¤F³\¦h§Þ¥©À³¥Îªº¤@ÃD

¬Û·í¤£¿ùªºÃD¥Ø






















¤å¥½¨¾¹p


--
¡° µo«H¯¸: §å½ð½ð¨ß(ptt2.cc) 
¡» From: 140.112.248.145

£p [1;30msa072686 [0;36mÂà[m:±q [sa072686] «H½c¡A¤_ 2009/12/16 Wed 06:20:06 [m
